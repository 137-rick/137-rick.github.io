I"{<div id="sina_keyword_ad_area2" class="articalContent   ">
  gearman managerå®‰è£…çš„æ—¶å€™ç”±äºå®˜æ–¹æ–‡æ¡£ä¸å¤ªå…¨ï¼Œè½¬äº†å‡ å¤§åœˆæ‰æå®š<br />ç°åœ¨è®°å½•ä¸‹æ¥&lt;/p&gt; 
  
  <p>
    å®‰è£…å‰éœ€è¦phpå®‰è£…pecntl<br /> php -m|grep pcntl å‘½ä»¤å¯æŸ¥çœ‹<br />å¦‚æœæ²¡æœ‰ä»»ä½•è¾“å‡ºå°±æ˜¯æ²¡å®‰è£…
  </p>
  
  <p>
    é¦–å…ˆå»å®˜æ–¹https://github.com/brianlmoon/GearmanManager<br />æŠŠä»–ä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹
  </p>
  
  <p>
    è¿›å…¥ç›®å½•installæ‰§è¡Œinstall.sh<br />ä¼šåˆ—å‡ºä¸€ä¸ªèœå•è®©ä½ é€‰æ‹©é‚£ç§æ–¹å¼ç®¡ç†worker<br />æˆ‘é€‰çš„pecl<br />ç³»ç»Ÿä¼šè‡ªåŠ¨æŠŠæ–‡ä»¶æ‹·è´åˆ°å‡ ä¸ªåœ°æ–¹ï¼š
  </p>
  
  <p>
    <b>å¯åŠ¨è„šæœ¬ä¿å­˜è·¯å¾„ï¼š</b> /usr/local/bin/gearman-manager<br /><b>pid æ–‡ä»¶ä¿å­˜è·¯å¾„ï¼š</b> /var/run/gearman<br /><b>logæ—¥å¿—æ–‡ä»¶ï¼š</b> /var/log/gearman-manager.log<br /><b>é…ç½®ï¼š</b>/etc/gearman-manager<br /><b>workeræ–‡ä»¶æ”¾ç½®ç›®å½•</b> åœ¨/etc/gearman-manager/workers/<br /><b>å…·ä½“çš„phpç³»ç»Ÿæ–‡ä»¶åœ¨</b> /usr/local/share/gearman-manager<br /><b>æœåŠ¡å¯åŠ¨å…³é—­æ–‡ä»¶åœ¨</b> /etc/init.d/gearman-manager
  </p>
  
  <p>
    åˆ—å‡ºè¿™å‡ ä¸ªåœ°æ–¹æ˜¯æœ‰åŸå› çš„ï¼Œå› ä¸ºä¸€ä¼šå„¿ä¿®æ•´è®©ä»–èƒ½å·¥ä½œè¿™äº›ç›®å½•éƒ½è¦çŸ¥é“â€¦â€¦
  </p>
  
  <p>
    å®‰è£…å®Œæ¯•
  </p>
  
  <p>
    <b>å¯åŠ¨gearman managerå‘½ä»¤å¦‚ä¸‹</b><br />/etc/init.d/gearman-manager start
  </p>
  
  <p>
    <b>å…³é—­ç”¨</b><br />/etc/init.d/gearman-manager stop
  </p>
  
  <p>
    å¦‚æœå¯åŠ¨æç¤º/usr/bin/env:php æ‰¾ä¸åˆ°æŒ‡å®šæ–‡ä»¶<br />è¿™ä¸ªæ—¶å€™éœ€è¦æˆ‘ä»¬å»pathç¯å¢ƒå˜é‡å†…æŒ‡å®šphpæ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ï¼Œå¹¶ä¸”<br />/usr/bin/php<br />ä¿è¯ä¸Šé¢è¿™ä¸ªç›®å½•æœ‰phpå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥æ‹·è´è¿‡å»æˆ–è€…lnè¿‡å»
  </p>
  
  <p>
    æå®šä¸Šé¢é—®é¢˜åï¼Œåœ¨workerä»£ç æ”¾ç½®ç›®å½•ä¸‹æ”¾ä¸€ä¸¤ä¸ªå®˜æ–¹æŒ‡å®šæ ¼å¼çš„workeræ–‡ä»¶è¿›å»ï¼Œå¯åŠ¨æœåŠ¡å<br />æ‰§è¡Œps -aux|grep gearman-manager<br />å¦‚æœå‘ç°ä¸€ä¸ªéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½ç¢°åˆ°äº†ä»¥ä¸‹é—®é¢˜
  </p>
  
  <p>
    æ•…éšœæ’é™¤è§£å†³æ–¹æ³•å¦‚ä¸‹<br />&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br /><b>æ•…éšœç°è±¡<br />æ‰§è¡Œ startåä¼šåœ¨ç¬¬ä¸€è¡Œè¾“å‡ºgearmand user not found</b>ç±»ä¼¼æç¤º<br />é‚£ä¹ˆä¿®æ”¹<br />vim /etc/init.d/gearman-manager<br />GEARMANUSER=&#8221;ç³»ç»Ÿå†…å·²ç»æœ‰çš„ç”¨æˆ·å&#8221;<br />è¿™ä¸ªæ˜¯å› ä¸ºæœåŠ¡å¯åŠ¨çš„æ—¶å€™è¦æŒ‡å®šä¸€ä¸ªç”¨æˆ·èº«ä»½ï¼Œä½†æ˜¯ç³»ç»Ÿæ²¡æœ‰è„šæœ¬é»˜è®¤çš„gearmandè¿™ä¸ªç”¨æˆ·ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™
  </p>
  
  <p>
    å¦‚æœç¢°åˆ°å¯åŠ¨åä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆç”¨ä¸€ä¸‹æ–¹å¼è§£å†³ä¸‹<br />&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br /><b>æ•…éšœç°è±¡</b>ï¼š<br />å½“åœæ­¢æœåŠ¡åï¼Œç”¨php /usr/local/share/gearman-manager/pecl-manager.php -vvv-c configæ–‡ä»¶æ‰€åœ¨è·¯å¾„<br />å¤§é‡è¾“å‡º<br />php: libgearman/universal.cc:486: gearman_return_tconnection_loop(gearman_universal_st&amp;, constgearman_packet_st&amp;, Check&amp;):Assertion `packet_ptr ==&amp;con-&gt;_packet&#8217; failed.<br />è¿™ä¸ªé”™è¯¯
  </p>
  
  <p>
    <b>è§£å†³æ–¹æ³•</b><br />vim /usr/local/share/gearman-manager/pecl-manager.php
  </p>
  
  <p>
    æ³¨é‡Š$thisWorker-&gt;addOptions(GEARMAN_WORKER_NON_BLOCKING);è¿™å¥å‘½ä»¤å³å¯<br />è¿™ä¸ªæ˜¯å› ä¸ºæŸbugå¯¼è‡´ä»–æŒ‚äº†â€¦â€¦æš‚æ—¶è¿™ä¹ˆæ”¹â€¦â€¦å…¶ä¸­phpæ‰©å±•çš„1.1.1ç‰ˆæœ¬å·²ç»è§£å†³è¿™ä¸ªé—®é¢˜<br />&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br />æœ€åæ˜¯å¯åŠ¨å‘½ä»¤ï¼Œæ‰”è¿™é‡Œäº†<br />/etc/init.d/gearman-manager start -c/etc/gearman-manager/config.ini -h ip:ç«¯å£,ip2:ç«¯å£
  </p>
</div>
:ET