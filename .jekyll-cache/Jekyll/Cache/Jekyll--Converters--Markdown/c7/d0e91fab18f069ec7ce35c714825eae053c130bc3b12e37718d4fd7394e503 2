I"	<div id="sina_keyword_ad_area2" class="articalContent   newfont_family">
  <div>
    ä½¿ç”¨swooleçš„evenloopå’Œphpçš„inotifyæ’ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç›‘æ§æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶æ›´æ–°ï¼Œåé¢ä¹Ÿä¸ç”¨å†™æ­»å¾ªç¯å’Œsleep
  </div>
  
  <div>
    å¦‚æœä½¿ç”¨åŸç”Ÿçš„phpæ˜¯éœ€è¦å†™whileæ­»å¾ªç¯å’Œsleepã€‚è¿™æ ·æ•ˆç‡ä¸æ˜¯å¾ˆé«˜
  </div>
  
  <div>
  </div>
  
  <div>
    $handleList = array();
  </div>
  
  <div>
  </div>
  
  <div>
    //init
  </div>
  
  <div>
    foreach ($this-&gt;_config[&#8220;log_path&#8221;] as$content) {
  </div>
  
  <div>
    $folder =$content[&#8220;path&#8221;];
  </div>
  
  <div>
  </div>
  
  <div>
    //if thefolder not exist
  </div>
  
  <div>
    if(!is_dir($folder)) {
  </div>
  
  <div>
    mkdir($folder, true);
  </div>
  
  <div>
    }
  </div>
  
  <div>
  </div>
  
  <div>
    //åˆ›å»ºä¸€ä¸ªinotifyå¥æŸ„
  </div>
  
  <div>
    $handleList[$folder][&#8220;fd&#8221;] = inotify_init();
  </div>
  
  <div>
  </div>
  
  <div>
    echo&#8221;Listen the folder:&#8221; . $folder . PHP_EOL;
  </div>
  
  <div>
    //ç›‘å¬æ–‡ä»¶ï¼Œä»…ç›‘å¬ä¿®æ”¹æ“ä½œï¼Œå¦‚æœæƒ³è¦ç›‘å¬æ‰€æœ‰äº‹ä»¶å¯ä»¥ä½¿ç”¨IN_ALL_EVENTS
  </div>
  
  <div>
    $handleList[$folder][&#8220;desc&#8221;] =inotify_add_watch($handleList[$folder][&#8220;fd&#8221;], $folder,IN_MODIFY);
  </div>
  
  <div>
  </div>
  
  <div>
    //åŠ å…¥åˆ°swooleçš„äº‹ä»¶å¾ªç¯ä¸­
  </div>
  
  <div>
    swoole_event_add($handleList[$folder][&#8220;fd&#8221;], function ($fd) use($folder) {
  </div>
  
  <div>
    $events =inotify_read($fd);
  </div>
  
  <div>
    if ($events) {
  </div>
  
  <div>
    var_dump($folder,$events);
  </div>
  
  <div>
    foreach ($events as $event) {
  </div>
  
  <div>
    //echo&#8221;inotify Event :&#8221; . var_export($event, 1) . &#8220;\n&#8221;;
  </div>
  
  <div>
    }
  </div>
  
  <div>
    }
  </div>
  
  <div>
    });
  </div>
  
  <div>
  </div>
  
  <div>
    åç»­è®°å¾—åé¢ä¸è¦è°ƒç”¨sleepä¹Ÿæ— éœ€whileæ­»å¾ªç¯
  </div>
  
  <div>
    ä»Šå¤©è¸©å‘æˆ‘åœ¨åé¢åŠ äº†while(true){sleep(5);}æ­»æ´»ä¸å·¥ä½œâ€¦â€¦åæ¥é—®äº†å³°å“¥â€¦â€¦æ‰çŸ¥é“ä¸¢äººäº†â€¦â€¦
  </div>
  
  <div>
  </div>
  
  <div>
    è¿™ä¸ªæ•ˆç‡å¾ˆé«˜â€¦dora-rpcçš„æ—¥å¿—æ”¶é›†å°±è¿™ä¹ˆå®šäº†ï¼Œæˆ‘ä¼šåšæ›´å¤šçš„æµ‹è¯•åæ›´æ–°github
  </div>
  
  <div>
  </div>
  
  <div>
    æœ€åå£°æ˜ï¼šè¿™æ®µä»£ç çš„åŸå§‹ç‰ˆæœ¬æ¥è‡ªéŸ©å¤©å³°çš„åˆ†äº«ï¼šhttp://my.oschina.net/matyhtf/blog/343508
  </div>
</div>
:ET